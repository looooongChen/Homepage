<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>tfAugment: Image Augmentation for Tensorflow &#8211; Long Chen | 陈龙</title> <meta name="description" content="Long Chen's personal blog"> <meta name="keywords" content="Image Augmentation, Machine Learnig"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://www.chen-long.com/assets/default/logo.jpg"> <meta name="twitter:title" content="tfAugment: Image Augmentation for Tensorflow"> <meta name="twitter:description" content="A python package for image augmentation. The package is designed to work seamlessly with tensorflow.data.Dataset."> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="tfAugment: Image Augmentation for Tensorflow"> <meta property="og:description" content="A python package for image augmentation. The package is designed to work seamlessly with tensorflow.data.Dataset."> <meta property="og:url" content="https://www.chen-long.com/softwares/2020-01-01-tfAugmentor/"> <meta property="og:site_name" content="Long Chen | 陈龙"> <meta property="og:image" content="https://www.chen-long.com/assets/default/logo.jpg"> <link rel="canonical" href="https://www.chen-long.com/softwares/2020-01-01-tfAugmentor/"> <link href="https://www.chen-long.com/feed.xml" type="application/atom+xml" rel="alternate" title="Long Chen | 陈龙 Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="https://www.chen-long.com/assets/css/main.css"> <link rel="stylesheet" href="https://www.chen-long.com/assets/css/academicons/css/academicons.min.css"/> <!-- JS --> <script src="https://www.chen-long.com/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <!-- <link rel="apple-touch-icon" href="https://www.chen-long.com/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://www.chen-long.com/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://www.chen-long.com/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://www.chen-long.com/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="https://www.chen-long.com/favicon.png" /> <link rel="shortcut icon" href="https://www.chen-long.com/favicon.ico" /> --> <!-- Background Image --> <style type="text/css">body {background-image:url(https://www.chen-long.com/assets/default/background.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="https://www.chen-long.com/">Home</a></li> <li><a href="https://www.chen-long.com/about/">About</a></li> <li><a href="https://www.chen-long.com/research&project/">Researches & Projects</a></li> <li><a href="https://www.chen-long.com/publication/">Publication</a></li> <li><a href="https://www.chen-long.com/software&dataset/">Software & Datasets</a></li> <!-- <li><a href="https://www.chen-long.com/blog/">Blog</a></li> --> <li> <a href="#">Blog</a> <ul class="dl-submenu"> <li><a href="https://www.chen-long.com/blog/">Recent Blogs</a></li> <li><a href="https://www.chen-long.com/blog-list/">Blog Archive</a></li> </ul> </li> <li><a href="https://www.chen-long.com/tags/">Tags Archive</a></li> <!-- <ul class="dl-submenu"> <li> <img src="https://www.chen-long.com/assets/default/logo.jpg" alt="Long Chen | 陈龙 photo" class="author-photo"> <h4>Long Chen | 陈龙</h4> <p>Long Chen's personal blog</p> </li> <li><a href="https://www.chen-long.com/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:looooong.chen@gmail.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://linkedin.com/in/long-chen-866a11134" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://instagram.com/looooong.chen" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-instagram"></i> Instagram</a> </li> <li> <a href="http://github.com/looooongChen" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul> </li>--> <!-- <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="https://www.chen-long.com/posts/">All Posts</a></li> <li><a href="https://www.chen-long.com/tags/">All Tags</a></li> </ul> </li> --> <!-- <li><a href="https://www.chen-long.com/projects/" >Projects</a></li> --> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>tfAugment: Image Augmentation for Tensorflow</h1> <h4>01 Jan 2020</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~5 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn", onclick="history.back(-1)"> <i class="fa fa-arrow-left"></i> </a> <a class="btn zoombtn" href="https://www.chen-long.com/software&dataset/"> <i class="fa fa-list"></i> </a> <a class="btn zoombtn" href="https://www.chen-long.com/software&dataset/"> <i class="fa fa-search"></i> </a> <a class="btn zoombtn" href="https://www.chen-long.com"> <i class="fa fa-home"></i> </a> </div> <table> <thead> <tr> <th style="text-align: center"> </th> <th style="text-align: center"> </th> <th style="text-align: center"> </th> <th style="text-align: center"> </th> <th style="text-align: center"> </th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><img src="/assets/software/tfAugmentor/demo_random_rotation.gif" alt="demo_ratation" /></td> <td style="text-align: center"><img src="/assets/software/tfAugmentor/demo_random_translation.gif" alt="demo_translation" /></td> <td style="text-align: center"><img src="/assets/software/tfAugmentor/demo_random_crop.gif" alt="demo_crop" /></td> <td style="text-align: center"><img src="/assets/software/tfAugmentor/demo_random_contrast.gif" alt="demo_contrast" /></td> <td style="text-align: center"><img src="/assets/software/tfAugmentor/demo_random_elastic.gif" alt="demo_elastic" /></td> </tr> </tbody> </table> <h2 id="installation">Installation</h2> <p>tfAugmentor is written in Python and can be easily installed via:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pip</span> <span class="n">install</span> <span class="n">tfAugmentor</span>
</code></pre></div></div> <p>Required packages:</p> <ul> <li>tensorflow (developed under tf 2.4), should work with any 2.x version</li> <li>numpy (numpy=1.20 may cause error of tf.meshgrid, use another version)</li> </ul> <h2 id="quick-start">Quick Start</h2> <p>tfAugmentor is implemented to work seamlessly with tf.data. The tf.data.Dataset object can be directly processed by tfAugmentor.</p> <p>To instantiate an <code class="highlighter-rouge">Augmentor</code> object, three arguments are required:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Augmentor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signature</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="p">[],</span> <span class="n">label_map</span><span class="o">=</span><span class="p">[]):</span>
		<span class="p">...</span>
</code></pre></div></div> <ul> <li>signature: to present the structure of the dataset <ul> <li>a nested tuple of string</li> <li>a list/tuple of dictionary keys, if your dataset is in a dictionary form</li> </ul> </li> <li>image: list of string items in signature, which will be treated as normal images</li> <li>label: list of string items in signature, which will be treated as segmentation masks</li> </ul> <p><strong>Note:</strong> only the items in ‘image’ and ‘label’ will be processed, others will remain untouched</p> <h3 id="a-simple-example">A simple example</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tfAugmentor</span> <span class="k">as</span> <span class="n">tfaug</span>

<span class="c1"># new tfAugmentor object
</span><span class="n">aug</span> <span class="o">=</span> <span class="n">tfaug</span><span class="p">.</span><span class="n">Augmentor</span><span class="p">(</span><span class="n">signature</span><span class="o">=</span><span class="p">(</span><span class="s">'image'</span><span class="p">,</span> <span class="p">(</span><span class="s">'mask1'</span><span class="p">,</span> <span class="s">'mask2'</span><span class="p">)),</span> 
                      <span class="n">image</span><span class="o">=</span><span class="p">[</span><span class="s">'image'</span><span class="p">],</span> 
                      <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s">'mask1'</span><span class="p">,</span> <span class="s">'mask2'</span><span class="p">])</span>

<span class="c1"># add augumentation operations
</span><span class="n">aug</span><span class="p">.</span><span class="n">flip_left_right</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">aug</span><span class="p">.</span><span class="n">rotate90</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">aug</span><span class="p">.</span><span class="n">elastic_deform</span><span class="p">(</span><span class="n">strength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># assume we have three numpy arrays
</span><span class="n">X_image</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [batch, height, width, channel]
</span><span class="n">Y_mask1</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [batch, height, width, 1]
</span><span class="n">Y_mask2</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [batch, height, width, 1]
</span>
<span class="c1"># create tf.data.Dataset object
</span><span class="n">tf_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">.</span><span class="n">from_tensor_slices</span><span class="p">((</span><span class="n">X_image</span><span class="p">,</span> <span class="p">(</span><span class="n">Y_mask1</span><span class="p">,</span> <span class="n">Y_mask2</span><span class="p">))))</span>
<span class="c1"># do the actual augmentation
</span><span class="n">ds1</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">tf_dataset</span><span class="p">)</span>

<span class="c1"># or you can directly pass the numpy arrays, a tf.data.Dataset object will be returned 
</span><span class="n">ds2</span> <span class="o">=</span> <span class="n">aug</span><span class="p">((</span><span class="n">X_image</span><span class="p">,</span> <span class="p">(</span><span class="n">Y_mask1</span><span class="p">,</span> <span class="n">Y_mask2</span><span class="p">))),</span> <span class="n">keep_size</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <p>If the data is passed as a python dictionary, the signature should be the list/tuple of keys. For example:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tfAugmentor</span> <span class="k">as</span> <span class="n">tfaug</span>

<span class="c1"># new tfAugmentor object
</span><span class="n">aug</span> <span class="o">=</span> <span class="n">tfaug</span><span class="p">.</span><span class="n">Augmentor</span><span class="p">(</span><span class="n">signature</span><span class="o">=</span><span class="p">(</span><span class="s">'image'</span><span class="p">,</span> <span class="s">'mask1'</span><span class="p">,</span> <span class="s">'mask2'</span><span class="p">),</span> 
                      <span class="n">image</span><span class="o">=</span><span class="p">[</span><span class="s">'image'</span><span class="p">],</span> 
                      <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s">'mask1'</span><span class="p">,</span> <span class="s">'mask2'</span><span class="p">])</span>

<span class="c1"># add augumentation operations
</span><span class="n">aug</span><span class="p">.</span><span class="n">flip_left_right</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">aug</span><span class="p">.</span><span class="n">rotate90</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">aug</span><span class="p">.</span><span class="n">elastic_deform</span><span class="p">(</span><span class="n">strength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># assume we have three numpy arrays
</span><span class="n">X_image</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [batch, height, width, channel]
</span><span class="n">Y_mask1</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [batch, height, width, 1]
</span><span class="n">Y_mask2</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [batch, height, width, 1]
</span>
<span class="n">ds_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">'image'</span><span class="p">:</span> <span class="n">X_image</span><span class="p">,</span>
           <span class="s">'mask1'</span><span class="p">:</span> <span class="n">Y_mask1</span><span class="p">,</span>
           <span class="s">'mask2'</span><span class="p">:</span> <span class="n">Y_mask2</span><span class="p">}</span>
<span class="c1"># create tf.data.Dataset object
</span><span class="n">tf_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">.</span><span class="n">from_tensor_slices</span><span class="p">(</span><span class="n">ds_dict</span><span class="p">)</span>
<span class="c1"># do the actual augmentation
</span><span class="n">ds1</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">tf_dataset</span><span class="p">)</span>

<span class="c1"># or directly pass the data
</span><span class="n">ds2</span> <span class="o">=</span> <span class="n">aug</span><span class="p">(</span><span class="n">ds_dict</span><span class="p">)</span>
</code></pre></div></div> <p><strong>Note:</strong> All added operations will be executed one by one, but you can create multiply tfAugmentor to realize parallel pipelines</p> <h3 id="a-more-complicated-example">A more complicated example</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tfAugmentor</span> <span class="k">as</span> <span class="n">tfaug</span>

<span class="c1"># since 'class' is neither in 'image' nor in 'label', it will not be processed 
</span><span class="n">aug1</span> <span class="o">=</span> <span class="n">tfaug</span><span class="p">.</span><span class="n">Augmentor</span><span class="p">(((</span><span class="s">'image_rgb'</span><span class="p">,</span> <span class="s">'image_depth'</span><span class="p">),</span> <span class="p">(</span><span class="s">'semantic_mask'</span><span class="p">,</span> <span class="s">'class'</span><span class="p">)),</span> 
                       <span class="n">image</span><span class="o">=</span><span class="p">[</span><span class="s">'image_rgb'</span><span class="p">,</span> <span class="s">'image_depth'</span><span class="p">],</span> 
                       <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s">'semantic_mask'</span><span class="p">])</span>
<span class="n">aug2</span> <span class="o">=</span> <span class="n">tfaug</span><span class="p">.</span><span class="n">Augmentor</span><span class="p">(((</span><span class="s">'image_rgb'</span><span class="p">,</span> <span class="s">'image_depth'</span><span class="p">),</span> <span class="p">(</span><span class="s">'semantic_mask'</span><span class="p">,</span> <span class="s">'class'</span><span class="p">)),</span> 
                       <span class="n">image</span><span class="o">=</span><span class="p">[</span><span class="s">'image_rgb'</span><span class="p">,</span> <span class="s">'image_depth'</span><span class="p">],</span> 
                       <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s">'semantic_mask'</span><span class="p">])</span>

<span class="c1"># add different augumentation operations to aug1 and aug2 
</span><span class="n">aug1</span><span class="p">.</span><span class="n">flip_left_right</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">aug1</span><span class="p">.</span><span class="n">random_crop_resize</span><span class="p">(</span><span class="n">sacle_range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span> <span class="n">probability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">aug2</span><span class="p">.</span><span class="n">elastic_deform</span><span class="p">(</span><span class="n">strength</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># assume we have the 1000 data samples
</span><span class="n">X_rgb</span> <span class="o">=</span> <span class="p">...</span>  <span class="c1"># shape [1000 x 512 x 512 x 3]
</span><span class="n">X_depth</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [1000 x 512 x 512 x 1]
</span><span class="n">Y_semantic_mask</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [1000 x 512 x 512 x 1]
</span><span class="n">Y_class</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># shape [1000 x 1]
</span>
<span class="c1"># create tf.data.Dataset object
</span><span class="n">ds_origin</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">.</span><span class="n">from_tensor_slices</span><span class="p">(((</span><span class="n">X_rgb</span><span class="p">,</span> <span class="n">X_depth</span><span class="p">),</span> <span class="p">(</span><span class="n">Y_semantic_mask</span><span class="p">,</span> <span class="n">Y_class</span><span class="p">))))</span>
<span class="c1"># do the actual augmentation
</span><span class="n">ds1</span> <span class="o">=</span> <span class="n">aug1</span><span class="p">(</span><span class="n">ds_origin</span><span class="p">)</span>
<span class="n">ds2</span> <span class="o">=</span> <span class="n">aug2</span><span class="p">(</span><span class="n">ds_origin</span><span class="p">)</span>
<span class="c1"># combine them
</span><span class="n">ds</span> <span class="o">=</span> <span class="n">ds_origin</span><span class="p">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">ds1</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">ds1</span><span class="p">)</span>

</code></pre></div></div> <h2 id="main-features">Main Features</h2> <p>The argument <strong>‘probability’</strong> controls the possibility of a certain augmentation taking place.</p> <h3 id="mirroring">Mirroring</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flip the image left right  
</span><span class="n">aug</span><span class="p">.</span><span class="n">flip_left_right</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># flip the image up down 
</span><span class="n">aug</span><span class="p">.</span><span class="n">flip_up_down</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
</code></pre></div></div> <h3 id="rotation">Rotation</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># rotate by 90 degree clockwise
</span><span class="n">a</span><span class="p">.</span><span class="n">rotate90</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="c1"># rotate by 180 degree clockwise
</span><span class="n">a</span><span class="p">.</span><span class="n">rotate180</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># rotate by 270 degree clockwise 
</span><span class="n">a</span><span class="p">.</span><span class="n">rotate270</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="c1"># rotate by a certrain degree, Args: angle - scala, in degree
</span><span class="n">a</span><span class="p">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="c1"># randomly rotate the image
</span><span class="n">a</span><span class="p">.</span><span class="n">random_rotate</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
</code></pre></div></div> <h3 id="translation">Translation</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># tranlate image, Args: offset - [x, y]
</span><span class="n">a</span><span class="p">.</span><span class="n">translate</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="c1"># randoms translate image 
</span><span class="n">a</span><span class="p">.</span><span class="n">random_translate</span><span class="p">(</span><span class="n">translation_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</code></pre></div></div> <h3 id="crop-and-resize">Crop and Resize</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># randomly crop a sub-image and resize to the original image size
</span><span class="n">a</span><span class="p">.</span><span class="n">random_crop</span><span class="p">(</span><span class="n">scale_range</span><span class="o">=</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="n">preserve_aspect_ratio</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
</code></pre></div></div> <h3 id="elastic-deformation">Elastic Deformation</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># performa elastic deformation
</span><span class="n">a</span><span class="p">.</span><span class="n">elastic_deform</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="photometric-adjustment">Photometric Adjustment</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># adjust image contrast randomly
</span><span class="n">a</span><span class="p">.</span><span class="n">random_contrast</span><span class="p">(</span><span class="n">contrast_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">],</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># perform gamma correction with random gamma values
</span><span class="n">a</span><span class="p">.</span><span class="n">random_gamma</span><span class="p">(</span><span class="n">gamma_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="noise">Noise</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># blur the image with gaussian kernel
</span><span class="n">a</span><span class="p">.</span><span class="n">gaussian_blur</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h2 id="caution">Caution</h2> <ul> <li>If .batch() of tf.data.Dataset is used before augmentation, please set <strong>drop_remainder=True</strong>. Oherwise, the batch_size will be set to None. The augmention of tfAgmentor requires the batch_size dimension</li> </ul> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="https://www.chen-long.com/tags/#Image Augmentation" title="Pages tagged Image Augmentation" class="tag"><span class="term">Image Augmentation</span></a><a href="https://www.chen-long.com/tags/#Machine Learnig" title="Pages tagged Machine Learnig" class="tag"><span class="term">Machine Learnig</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.chen-long.com/softwares/2020-01-01-tfAugmentor/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=https://www.chen-long.com/softwares/2020-01-01-tfAugmentor/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="https://www.chen-long.com/assets/js/jquery-1.12.0.min.js"></script> <script src="https://www.chen-long.com/assets/js/jquery.dlmenu.min.js"></script> <script src="https://www.chen-long.com/assets/js/jquery.goup.min.js"></script> <script src="https://www.chen-long.com/assets/js/jquery.magnific-popup.min.js"></script> <script src="https://www.chen-long.com/assets/js/jquery.fitvid.min.js"></script> <script src="https://www.chen-long.com/assets/js/scripts.js"></script> <!-- Asynchronous Google Analytics snippet --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-170636157-1', 'auto'); ga('require', 'linkid', 'linkid.js'); ga('send', 'pageview'); </script> <script type="text/javascript"> var disqus_shortname = 'taylantatli'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
